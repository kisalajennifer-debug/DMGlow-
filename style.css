async function generateReply() {

  const message = document.getElementById("userInput").value.trim();
  const intensity = document.getElementById("intensity").value;
  const output = document.getElementById("outputArea");

  if (!message) {
    alert("Enter a message first.");
    return;
  }

  output.innerHTML = "Generating...";

  try {

    const response = await fetch("/api/generate", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ message, intensity })
    });

    const data = await response.json();

    output.innerHTML = "";

    if (!data.replies || data.replies.length === 0) {
      output.innerHTML = "No replies generated.";
      return;
    }

    data.replies.forEach(reply => {

      const box = document.createElement("div");
      box.className = "reply-box";

      // MAIN REPLY TEXT
      const content = document.createElement("div");
      content.className = "reply-content";
      content.textContent = reply;

      // TONE SECTION
      const toneSection = document.createElement("div");
      toneSection.className = "tone-section";

      const detectedTones = detectTones(reply);

      detectedTones.forEach(tone => {
        const tag = document.createElement("span");
        tag.className = "tone-label " + tone.class;
        tag.textContent = tone.label;
        toneSection.appendChild(tag);
      });

      box.appendChild(content);
      box.appendChild(toneSection);

      output.appendChild(box);
    });

  } catch (err) {
    output.innerHTML = "Error generating reply.";
    console.error(err);
  }
}


/* =========================
   SIMPLE FRONTEND TONE DETECTION
========================= */

function detectTones(text) {

  const tones = [];

  const lower = text.toLowerCase();

  if (/respect|standard|boundary|position/.test(lower)) {
    tones.push({ label: "Authority", class: "tone-authority" });
  }

  if (/energy|emotion|feel|intensity/.test(lower)) {
    tones.push({ label: "Psychological", class: "tone-psychological" });
  }

  if (/steady|calm|balance|composure/.test(lower)) {
    tones.push({ label: "Smooth", class: "tone-smooth" });
  }

  if (/control|frame|dominant|lead/.test(lower)) {
    tones.push({ label: "Dominant", class: "tone-dominant" });
  }

  // If nothing detected, default tone
  if (tones.length === 0) {
    tones.push({ label: "Adaptive", class: "tone-smooth" });
  }

  return tones;
    }
.reply-text{
  font-size:15px;
  line-height:1.6;
  margin-bottom:14px;
}

.tone-container{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
}

.tone-badge{
  padding:6px 12px;
  border-radius:14px;
  font-size:11px;
  background:rgba(232,197,108,0.15);
  color:#E8C56C;
  border:1px solid rgba(232,197,108,0.4);
  letter-spacing:0.3px;
      }
.main-reply-card{
  margin-top:22px;
  padding:26px;
  border-radius:28px;
  background:linear-gradient(145deg,#13283F,#0F2236);
  border:2px solid #E8C56C;
  box-shadow:0 0 25px rgba(232,197,108,0.35);
  font-size:16px;
  line-height:1.6;
}

.tone-card{
  margin-top:18px;
  padding:20px;
  border-radius:24px;
  background:#13283F;
  border:1px solid rgba(232,197,108,0.4);
  transition:0.3s ease;
}

.tone-card:hover{
  box-shadow:0 0 18px rgba(232,197,108,0.35);
  transform:translateY(-3px);
}

.tone-title{
  font-size:13px;
  color:#E8C56C;
  margin-bottom:8px;
  letter-spacing:0.5px;
  font-weight:600;
}

.tone-text{
  font-size:14px;
  line-height:1.5;
    }
